{
  "name": "HCP Consul",
  "description": null,
  "pages": [
    {
      "name": "Overview",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "[![HCP Consul](https://www.datocms-assets.com/58478/1638210562-logo.svg)](https://www.consul.io/)\n\nThis dashboard provides visibility into the health of your HCP Consul environment. It relies on data collected by the [HCP Consul integration](https://newrelic.com/instant-observability/hcp-consul/bc99ad15-7aba-450e-8236-6ea667d50cae).\n\n\n---\nThe dashboard includes the following tabs:\n- **Overview** - key indicators describing the overall health of your environment\n- **Client** - Insight into the health of your client membership\n- **Network** - Insight into the health of requests moving between your nodes\n- **Runtime** - Insight into the health of your node runtimes\n- **Serf** - Insight into the health of node discovery and orchestration\n- **Envoy** - Insight into the performance of the Envoy proxy\n\n"
          }
        },
        {
          "title": "Clusters (edit to enable filtering)",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 5,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT uniqueCount(consul.source.datacenter) where consul.source.datacenter is not null facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "License: Hours to Expiry",
          "layout": {
            "column": 10,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT round(min(consul.system.licenseExpiration)) as 'Hours' FROM Metric facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Client Health: API Http Calls",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.api.http.summary) from Metric facet consul.source.datacenter TIMESERIES limit 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Client Health: KVS Apply (ms)",
          "layout": {
            "column": 4,
            "row": 4,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.kvs.apply) from Metric facet consul.source.datacenter TIMESERIES limit 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Client Health: Txn Apply (ms)",
          "layout": {
            "column": 7,
            "row": 4,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.txn.apply) from Metric facet consul.source.datacenter TIMESERIES limit 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Client Health: Node Flaps",
          "layout": {
            "column": 10,
            "row": 4,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.serf.member.flap) as 'Node flaps' from Metric facet consul.source.datacenter TIMESERIES limit 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Network: RPC",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.client.rpc) as 'RPC Requests' FROM Metric SINCE 5 minutes ago where metricName = 'consul.client.rpc' TIMESERIES facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Network: RPC Exceeded",
          "layout": {
            "column": 5,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.client.rpc.exceeded) as 'RPC Exceeded' FROM Metric since 5 minutes ago facet consul.source.datacenter TIMESERIES limit 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Network: RPC Failed",
          "layout": {
            "column": 9,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.client.rpc.failed) as 'RPC Failed' FROM Metric since 5 minutes ago facet consul.source.datacenter TIMESERIES limit 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Runtime: GC Pause (ms)",
          "layout": {
            "column": 1,
            "row": 10,
            "width": 2,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "dataFormatters": [],
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT rate(sum(consul.runtime.gc_pause_ns.mean)/1000000, 1 minute) as 'Avg GC Pause (ms)' where metricName like 'consul.runtime.gc_pause_ns.mean' since 5 minute ago"
              }
            ],
            "thresholds": [
              {
                "alertSeverity": "WARNING",
                "value": 2000
              },
              {
                "alertSeverity": "CRITICAL",
                "value": 5000
              }
            ]
          }
        },
        {
          "title": "Runtime: GC Pause (ms)",
          "layout": {
            "column": 3,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT rate(sum(consul.runtime.gc_pause_ns.mean)/1000000, 1 minute) as 'Avg GC Pause (ms)' where metricName like 'consul.runtime.gc_pause_ns.mean' since 5 minute ago TIMESERIES facet consul.source.datacenter limit 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Runtime: System Bytes",
          "layout": {
            "column": 7,
            "row": 10,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(latest(consul.runtime.sys_bytes), 1 minute) from Metric since 5 minute ago TIMESERIES facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Runtime: Allocated Bytes",
          "layout": {
            "column": 10,
            "row": 10,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(latest(consul.runtime.alloc_bytes), 1 minute) from Metric since 5 minute ago TIMESERIES 1 minute facet consul.source.datacenter"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Envoy: Active Clusters",
          "layout": {
            "column": 1,
            "row": 13,
            "width": 2,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT latest(envoy.cluster_manager.active_clusters) where consul.source.datacenter is not null SINCE 30 minutes ago facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Envoy: Unhealthy Cluster Members",
          "layout": {
            "column": 3,
            "row": 13,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT clamp_min(sum(envoy.cluster.membership_total)-sum(envoy.cluster.membership_healthy), 0) SINCE 30 minutes ago FACET consul.source.datacenter TIMESERIES LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Envoy: Server, % of Heap Allocated",
          "layout": {
            "column": 7,
            "row": 13,
            "width": 2,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT average(envoy.server.memory_allocated)/average(envoy.server.memory_heap_size) * 100 SINCE 30 minutes ago facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Envoy: Total HTTP Requests",
          "layout": {
            "column": 9,
            "row": 13,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT sum(envoy.http.rq_total) SINCE 30 minutes ago FACET consul.source.datacenter TIMESERIES limit 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    },
    {
      "name": "Client",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "## HCP Consul: Client Health\n\nThe dashboard focuses on the health of your HCP Client members, including:\n- API HTTP calls\n- Txn/KVS\n- Nodes and Messages\n- Consul Cache \n\nThe charts in this dashboard show the **top 50** Client instances for each metric. To view more Client instances, you can change the query by selecting \"Edit Query\" in the chart's action menu.\n\nPlease check the [official documentation](https://www.consul.io/docs/agent/telemetry) for a full listing of Consul Telemetry. (Note: HCP Consul does not emit Server telemetry, including Raft telemetry.)\n \nIn Query Builder, run a query like the following to see the full list of metrics available in your data:\n\n```FROM Metric SELECT * WHERE metricName like '%consul%' LIMIT MAX```\n"
          }
        },
        {
          "title": "Clusters (edit to enable filtering)",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT uniqueCount(consul.source.datacenter) where consul.source.datacenter is not null facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Clients (edit to enable filtering)",
          "layout": {
            "column": 9,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT uniqueCount(statsdSource) as 'Client' where consul.source.datacenter is not null and metricName not like 'envoy%' facet statsdSource limit MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Total API HTTP Calls",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 6,
            "height": 6
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.api.http.summary) from Metric TIMESERIES LIMIT 50 facet statsdSource, path, method"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "API Http Avg Duration (ms)",
          "layout": {
            "column": 7,
            "row": 4,
            "width": 6,
            "height": 6
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.api.http.summary) from Metric facet statsdSource, path, method TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Txn Apply (ms)",
          "layout": {
            "column": 1,
            "row": 10,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.txn.apply) from Metric facet statsdSource TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "KVS Apply (ms)",
          "layout": {
            "column": 7,
            "row": 10,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.kvs.apply) from Metric facet statsdSource TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Node Flaps",
          "layout": {
            "column": 1,
            "row": 13,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.serf.member.flap) as 'Node flaps' from Metric facet statsdSource TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Node Health Score",
          "layout": {
            "column": 5,
            "row": 13,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.memberlist.health.score) as 'Health Score' from Metric where metricName = 'consul.memberlist.health.score' TIMESERIES facet statsdSource limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Node Probe Duration (ms)",
          "layout": {
            "column": 9,
            "row": 13,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.memberlist.probeNode.summary) as 'Avg Probe Duration (ms)' from Metric where metricName = 'consul.memberlist.probeNode.summary' TIMESERIES facet statsdSource limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Gossip Message Duration (ms)",
          "layout": {
            "column": 1,
            "row": 16,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.memberlist.gossip.summary) as 'Duration (ms)' from Metric where metricName = 'consul.memberlist.gossip.summary' TIMESERIES facet statsdSource limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Messages: Alive",
          "layout": {
            "column": 4,
            "row": 16,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.memberlist.msg.alive) from Metric where metricName = 'consul.memberlist.msg.alive' TIMESERIES facet statsdSource limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Messages: Dead",
          "layout": {
            "column": 7,
            "row": 16,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.memberlist.msg.dead) as 'Dead' from Metric where metricName = 'consul.memberlist.msg.dead' TIMESERIES facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Messages: Suspect",
          "layout": {
            "column": 10,
            "row": 16,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.memberlist.msg.suspect) from Metric where metricName = 'consul.memberlist.msg.suspect' TIMESERIES facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 19,
            "width": 12,
            "height": 1
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "# Cache"
          }
        },
        {
          "title": "Consul Cache: Fetch Errors",
          "layout": {
            "column": 1,
            "row": 20,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.consul.cache.fetch_error) as 'Fetch Errors' from Metric where metricName = 'consul.consul.cache.fetch_error' FACET statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Consul Cache: Fetch Successes",
          "layout": {
            "column": 5,
            "row": 20,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.consul.cache.fetch_success.per_second) as 'Fetch Successes' from Metric where metricName = 'consul.consul.cache.fetch_success.per_second' FACET statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Consul Cache: Entries",
          "layout": {
            "column": 9,
            "row": 20,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.consul.cache.entries_count) as 'Cache Entries' from Metric where metricName = 'consul.consul.cache.entries_count' FACET statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    },
    {
      "name": "Network",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "## HCP Consul: Network\n\nThis dashboard focuses on indicators regarding HCP Consul network health, including statistics on:\n- RPC\n- TCP\n- UDP\n- gRCP\n\nThe charts in this dashboard show the **top 50** Client instances for each metric. To view more Client instances, you can change the query by selecting \"Edit Query\" in the chart's action menu.\n\nPlease check the [official documentation](https://www.consul.io/docs/agent/telemetry) for a full listing of Consul Telemetry. (Note: HCP Consul does not emit Server telemetry, including Raft telemetry.)\n \nIn Query Builder, run a query like the following to see the full list of metrics available in your data:\n\n```FROM Metric SELECT * WHERE metricName like '%consul%' LIMIT MAX```\n"
          }
        },
        {
          "title": "Clusters (edit to enable filtering)",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT uniqueCount(consul.source.datacenter) where consul.source.datacenter is not null facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Clients (edit to enable filtering)",
          "layout": {
            "column": 9,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT uniqueCount(statsdSource) as 'Client' where consul.source.datacenter is not null and metricName not like 'envoy%' facet statsdSource LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "RPC",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 4,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.client.rpc) as 'RPC Requests' FROM Metric where metricName = 'consul.client.rpc' FACET statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Network: RPC Exceeded",
          "layout": {
            "column": 5,
            "row": 4,
            "width": 4,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.client.rpc.exceeded) as 'RPC Exceeded' FROM Metric FACET statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Network: RPC Failed",
          "layout": {
            "column": 9,
            "row": 4,
            "width": 4,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.client.rpc.failed) as 'RPC Failed' FROM Metric FACET statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "TCP: Connects",
          "layout": {
            "column": 1,
            "row": 8,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.memberlist.tcp.connect) as 'Connects' from Metric where metricName IN ('consul.memberlist.tcp.connect') facet statsdSource TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "TCP: Accepts",
          "layout": {
            "column": 5,
            "row": 8,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.memberlist.tcp.accept) as 'Accepts' from Metric where metricName IN ('consul.memberlist.tcp.accept') facet statsdSource limit 50 timeseries"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "TCP: Avg Bytes Sent",
          "layout": {
            "column": 9,
            "row": 8,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.memberlist.tcp.sent) as 'Bytes Sent' from Metric where metricName IN ('consul.memberlist.tcp.sent') TIMESERIES facet statsdSource limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "UDP: Avg Bytes Sent",
          "layout": {
            "column": 1,
            "row": 11,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.memberlist.udp.sent) from Metric where metricName = 'consul.memberlist.udp.sent' TIMESERIES facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "UDP: Avg Bytes Received",
          "layout": {
            "column": 7,
            "row": 11,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.memberlist.udp.received) from Metric where metricName = 'consul.memberlist.udp.received' TIMESERIES facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "gRPC Active Connections to Server",
          "layout": {
            "column": 1,
            "row": 14,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.grpc.client.connections) as 'gRPC Connections' from Metric where metricName = 'consul.grpc.client.connections' FACET statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "gRPC Requests to Server",
          "layout": {
            "column": 7,
            "row": 14,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.grpc.client.request.count) as 'gRPC Requests' from Metric where metricName = 'consul.grpc.client.request.count' FACET statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    },
    {
      "name": "Runtime",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "## HCP Consul: Runtime\n\nThis dashboard focues on statistics indicative of runtime health:\n- garbage collection\n- heap size and allocation\n- Go routines\n\nThe charts in this dashboard show the **top 50** Client instances for each metric. To view more Client instances, you can change the query by selecting \"Edit Query\" in the chart's action menu.\n\nPlease check the [official documentation](https://www.consul.io/docs/agent/telemetry) for a full listing of Consul Telemetry. (Note: HCP Consul does not emit Server telemetry, including Raft telemetry.)\n \nIn Query Builder, run a query like the following to see the full list of metrics available in your data:\n\n```FROM Metric SELECT * WHERE metricName like '%consul%' LIMIT MAX```\n"
          }
        },
        {
          "title": "Clusters (edit to enable filtering)",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT uniqueCount(consul.source.datacenter) where consul.source.datacenter is not null facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Clients (edit to enable filtering)",
          "layout": {
            "column": 9,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT uniqueCount(statsdSource) as 'Client' where consul.source.datacenter is not null and metricName not like 'envoy%' facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "GC Pause (ms)",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 2,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "dataFormatters": [],
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT rate(sum(consul.runtime.gc_pause_ns.mean)/1000000, 1 minute) as 'Avg GC Pause (ms)' where metricName like 'consul.runtime.gc_pause_ns.mean' since 5 minutes ago"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "thresholds": [
              {
                "alertSeverity": "WARNING",
                "value": 2000
              },
              {
                "alertSeverity": "CRITICAL",
                "value": 5000
              }
            ]
          }
        },
        {
          "title": "GC Pause (ms)",
          "layout": {
            "column": 3,
            "row": 4,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT rate(sum(consul.runtime.gc_pause_ns.mean)/1000000, 1 minute) as 'Avg GC Pause (ms)' where metricName like 'consul.runtime.gc_pause_ns.mean' TIMESERIES 1 minute facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Total GC Runs (Agent Lifetime)",
          "layout": {
            "column": 9,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT latest(consul.runtime.total_gc_runs) as 'GC Runs' where metricName like 'consul.runtime.total_gc_runs' since 5 minutes ago facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Heap Objects",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 2,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(consul.runtime.heap_objects) as 'Heap Objects' from Metric since 5 minutes ago facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Heap Objects",
          "layout": {
            "column": 3,
            "row": 7,
            "width": 6,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT latest(consul.runtime.heap_objects) as 'Heap Objects' from Metric TIMESERIES facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Available Bytes",
          "layout": {
            "column": 9,
            "row": 7,
            "width": 4,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT rate(latest(consul.runtime.sys_bytes)/1000000, 1 minute)-rate(latest(consul.runtime.alloc_bytes)/1000000, 1 minute) from Metric TIMESERIES 1 minute facet statsdSource limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Go Routines",
          "layout": {
            "column": 1,
            "row": 11,
            "width": 8,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.runtime.num_goroutines)  as 'Go Routines' from Metric WHERE metricName = 'consul.runtime.num_goroutines' TIMESERIES facet statsdSource limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Malloc Count",
          "layout": {
            "column": 9,
            "row": 11,
            "width": 2,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.runtime.malloc_count)  as 'Malloc Count' from Metric WHERE metricName = 'consul.runtime.malloc_count'  facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Free Count",
          "layout": {
            "column": 11,
            "row": 11,
            "width": 2,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(consul.runtime.free_count)  as 'Free Count' from Metric WHERE metricName = 'consul.runtime.free_count' facet statsdSource LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        }
      ]
    },
    {
      "name": "Serf",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "## HCP Consul: Serf\n\nConsul uses Serf to manage cluster membership and message broadcasting. This dashboard highlights some key statistics regarding Serf performance within your HCP Consul environment - however, please note that Serf telemetry is principally generated by Consul Servers, rather than Clients. You will principally see Serf telemetry during the intial communication of the Client agent with the Server.\n\nThe charts in this dashboard show the **top 50** Client instances for each metric. To view more Client instances, you can change the query by selecting \"Edit Query\" in the chart's action menu.\n\nPlease check the [official documentation](https://www.consul.io/docs/agent/telemetry) for a full listing of Consul Telemetry. (Note: HCP Consul does not emit Server telemetry, including Raft telemetry.)\n \nIn Query Builder, run a query like the following to see the full list of metrics available in your data:\n\n```FROM Metric SELECT * WHERE metricName like 'consul.serf%' LIMIT MAX```\n"
          }
        },
        {
          "title": "Clusters (edit to enable filtering)",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT uniqueCount(consul.source.datacenter) where consul.source.datacenter is not null facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Clients (edit to enable filtering)",
          "layout": {
            "column": 9,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT uniqueCount(statsdSource) as 'Client' where consul.source.datacenter is not null and metricName not like 'envoy%' facet statsdSource LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Serf: New Leader",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(`consul.serf.events.consul_new-leader`)  as 'New Leaders' from Metric where metricName = 'consul.serf.events.consul_new-leader' facet statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Serf Queue: Events",
          "layout": {
            "column": 5,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.serf.queue.Event.summary)  as 'Events' from Metric facet statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Serf Queue: Queries",
          "layout": {
            "column": 9,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.serf.queue.Query.summary) as 'Queries' from Metric facet statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Serf: Snapshot Append Line",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(consul.serf.snapshot.appendLine.summary) as 'Time to Append (ms)' from Metric where metricName = 'consul.serf.snapshot.appendLine.summary' facet statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Serf: Messages Sent",
          "layout": {
            "column": 5,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.serf.msgs.sent.summary) as 'Sent' from Metric where metricName = 'consul.serf.msgs.sent.summary' facet statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Serf: Messages Received",
          "layout": {
            "column": 9,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.serf.msgs.received.summary) as 'Received' from Metric where metricName IN ('consul.serf.msgs.received.summary', 'consul.serf.msgs.sent.summary') facet statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Serf: Member Joined",
          "layout": {
            "column": 1,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.serf.member.joined)  as 'Joined' from Metric facet statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Serf: Member Left",
          "layout": {
            "column": 5,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.serf.member.left)  as 'Left' from Metric facet statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Serf: Member Failed",
          "layout": {
            "column": 9,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT count(consul.serf.member.failed)  as 'Failed' from Metric facet statsdSource TIMESERIES LIMIT 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    },
    {
      "name": "Envoy",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "## Envoy\n\nHCP Consul leverages Envoy proxy server for network abstraction and traffic routing. This dashboard relies on data collected by the [HCP Consul Envoy integration](https://newrelic.com/instant-observability/hcp-envoy/64da4a3b-bfc9-4c18-9d98-55e250c955bd) and highlights key indicators for Envoy, focusing on:\n- Envoy server health\n- cluster membership health\n- network traffic performance\n\nPlease check the [official documentation](https://www.envoyproxy.io/docs/envoy/latest/configuration/configuration) for more information regarding Envoy Telemetry.\n \nIn Query Builder, run a query like the following to see the full list of metrics available in your data:\n\n```FROM Metric SELECT * WHERE metricName like 'envoy%' LIMIT MAX```"
          }
        },
        {
          "title": "Active Clusters (edit to enable filtering)",
          "layout": {
            "column": 4,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT latest(envoy.cluster_manager.active_clusters) where consul.source.datacenter is not null facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Warming Clusters",
          "layout": {
            "column": 7,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT latest(envoy.cluster_manager.warming_clusters) where consul.source.datacenter is not null facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Total HTTP Requests",
          "layout": {
            "column": 10,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT sum(envoy.http.rq_total) FACET consul.source.datacenter TIMESERIES limit 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Live Servers",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT latest(envoy.server.live) facet consul.source.datacenter TIMESERIES LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Server % of Heap Allocated",
          "layout": {
            "column": 4,
            "row": 4,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT average(envoy.server.memory_allocated)/average(envoy.server.memory_heap_size) * 100 facet consul.source.datacenter LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Server % of Heap Allocated",
          "layout": {
            "column": 7,
            "row": 4,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT average(envoy.server.memory_allocated)/average(envoy.server.memory_heap_size) * 100 facet consul.source.datacenter TIMESERIES LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Server Uptime (Hours)",
          "layout": {
            "column": 10,
            "row": 4,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.area"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT latest(envoy.server.uptime)/3600 facet consul.source.datacenter TIMESERIES LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Total Cluster Members",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT round(rate(sum(envoy.cluster.membership_total), 15 seconds)) FACET consul.source.datacenter TIMESERIES LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Unhealthy Cluster Members",
          "layout": {
            "column": 5,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT clamp_min(sum(envoy.cluster.membership_total)-sum(envoy.cluster.membership_healthy), 0) FACET consul.source.datacenter TIMESERIES LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Degraded Cluster Members",
          "layout": {
            "column": 9,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT round(rate(sum(envoy.cluster.membership_degraded), 15 seconds)) FACET consul.source.datacenter TIMESERIES LIMIT 25"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Active Upstream Connections",
          "layout": {
            "column": 1,
            "row": 10,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT round(average(envoy.cluster.upstream_cx_active)) FACET envoy.cluster_name, consul.source.datacenter TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Upstream Requests",
          "layout": {
            "column": 4,
            "row": 10,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT sum(envoy.cluster.upstream_rq_total) FACET envoy.cluster_name, consul.source.datacenter TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Upstream Network Traffic (Bytes)",
          "layout": {
            "column": 7,
            "row": 10,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT sum(envoy.cluster.upstream_cx_rx_bytes_total) FACET envoy.cluster_name, consul.source.datacenter TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Active Downstream Connections",
          "layout": {
            "column": 1,
            "row": 13,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT round(average(envoy.listener.downstream_cx_total)) FACET consul.source.datacenter, envoy.listener_address TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Downstream Requests Average Length (ms)",
          "layout": {
            "column": 7,
            "row": 13,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric SELECT average(envoy.listener.downstream_cx_length_ms.per_second) FACET consul.source.datacenter, envoy.listener_address TIMESERIES limit 50"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    }
  ]
}