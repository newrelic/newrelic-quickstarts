{
  "name": "eBPF",
  "description": null,
  "pages": [
    {
      "name": "TCP metrics",
      "description": null,
      "widgets": [
        {
          "title": null,
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "# ![eBPF Logo](https://user-images.githubusercontent.com/45159366/145732233-75bd4258-e436-404d-a707-4dca9a1d5beb.png) eBPF Observability\n\nOptimize system and application efficiency without altering your code. Get Kernel-deep visibility into your Kubernetes and on-host workloads to quickly identify and troubleshoot performance bottlenecks, issues, and security vulnerabilities.\n\n- [See eBPF entities](https://one.newrelic.com/ebpf \"ebpf capability\")\n- [See our docs](https://docs.newrelic.com/docs/ebpf/overview/)\n- [What is eBPF, and why does it matter for observability](https://newrelic.com/blog/best-practices/what-is-ebpf \"Blog Post\")"
          }
        },
        {
          "title": "DNS resolution (failure)",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 8,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Span SELECT count(*) AS 'Failure Count' WHERE protocol.name='dns' and dns.query != '[]' and dns.query != '' and entity.name IN ({{entity_name}}) AND dns.resolved=false FACET entity.name, dns.query LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            }
          }
        },
        {
          "title": "DNS resolution (success/failure)",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Span SELECT count(*) WHERE protocol.name='dns' and dns.query != '[]' and dns.query != '' and entity.name IN ({{entity_name}}) FACET dns.resolved_status, entity.name LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "DNS resolution count",
          "layout": {
            "column": 7,
            "row": 4,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.pie"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": true
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Span SELECT count(*) WHERE protocol.name='dns' and dns.query != '[]' and dns.query != '' and entity.name IN ({{entity_name}}) FACET dns.resolved_status, entity.name LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] bytes sent",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.tx) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' FACET entity.name, local_addr, local_port limit max TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "BYTES"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] bytes received",
          "layout": {
            "column": 5,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.rx) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' FACET entity.name, local_addr, local_port limit max TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "BYTES"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] bytes dropped",
          "layout": {
            "column": 9,
            "row": 7,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.retransmits) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' FACET entity.name, local_addr, local_port limit max TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] bytes sent",
          "layout": {
            "column": 1,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.tx) as 'Bytes Sent' where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' FACET entity.name limit max TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "BYTES"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] bytes received",
          "layout": {
            "column": 5,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.rx) as 'Bytes Received' where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' FACET entity.name limit max TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "BYTES"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] bytes dropped",
          "layout": {
            "column": 9,
            "row": 10,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.retransmits) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' FACET entity.name,  remote_addr limit max TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] TCP connection count (success/failure)",
          "layout": {
            "column": 1,
            "row": 13,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.open) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' and tcp_established='Success' FACET tcp_established, entity.name LIMIT MAX TIMESERIES"
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.open) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' and tcp_established='Failure' FACET tcp_established, entity.name LIMIT MAX TIMESERIES "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] TCP connection count (success/failure)",
          "layout": {
            "column": 7,
            "row": 13,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.open) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' and tcp_established='Success' FACET tcp_established, entity.name LIMIT MAX TIMESERIES"
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.close) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' and tcp_established='Failure' FACET tcp_established, entity.name LIMIT MAX TIMESERIES "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] TCP connection errors",
          "layout": {
            "column": 1,
            "row": 16,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.error) AS Error where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' and error != '' and error IS NOT NULL FACET error, entity.name, local_addr, local_port LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] TCP connection errors",
          "layout": {
            "column": 7,
            "row": 16,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.error) AS Error where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' and error != '' and error IS NOT NULL FACET error, entity.name LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] TCP connection (success)",
          "layout": {
            "column": 1,
            "row": 19,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.open) where entity.name IN ({{entity_name}}) and tcp_established = 'Success' and direction = 'INCOMING' and ebpf.tcp.connection.open != 0 FACET entity.name, local_addr, local_port LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] TCP connection (success)",
          "layout": {
            "column": 4,
            "row": 19,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.open) where entity.name IN ({{entity_name}}) and tcp_established = 'Success' and ebpf.tcp.connection.open != 0 and direction = 'OUTGOING' FACET entity.name, remote_addr LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] TCP connection (failure)",
          "layout": {
            "column": 7,
            "row": 19,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.close) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and tcp_established = 'Failure' and direction = 'INCOMING' and ebpf.tcp.connection.close != 0 FACET entity.name, local_addr, local_port LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] TCP connection (failure)",
          "layout": {
            "column": 10,
            "row": 19,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.close) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and tcp_established = 'Failure' and direction = 'OUTGOING' and ebpf.tcp.connection.close != 0 FACET entity.name, remote_addr LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] TCP handshake latency",
          "layout": {
            "column": 1,
            "row": 22,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT percentile(ebpf.tcp.handshake_latency,{{percentile_value}})/1000000 where entity.name IN ({{entity_name}}) and metricName='ebpf.tcp.handshake_latency' and ebpf.tcp.handshake_latency is NOT NULL and direction='INCOMING' FACET entity.name, local_addr, local_port TIMESERIES limit max"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] TCP socket connection duration",
          "layout": {
            "column": 5,
            "row": 22,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT percentile(ebpf.tcp.connection_duration, {{percentile_value}}) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' FACET entity.name,  local_addr, local_port LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] data transmit duration",
          "layout": {
            "column": 9,
            "row": 22,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT percentile(ebpf.tcp.data_transmit_duration, {{percentile_value}}) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' FACET entity.name,  local_addr, local_port LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] TCP handshake latency",
          "layout": {
            "column": 1,
            "row": 25,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT percentile(ebpf.tcp.handshake_latency, {{percentile_value}})/1000000 where entity.name IN ({{entity_name}}) and metricName='ebpf.tcp.handshake_latency' and ebpf.tcp.handshake_latency is NOT NULL and direction='OUTGOING' FACET entity.name order by max(ebpf.tcp.handshake_latency) TIMESERIES limit max"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] TCP socket connection duration",
          "layout": {
            "column": 5,
            "row": 25,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT percentile(ebpf.tcp.connection_duration, {{percentile_value}}) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' FACET entity.name LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] data transmit duration",
          "layout": {
            "column": 9,
            "row": 25,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT percentile(ebpf.tcp.data_transmit_duration, {{percentile_value}}) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' FACET entity.name LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] TCP packet codes",
          "layout": {
            "column": 1,
            "row": 28,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.syn.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES"
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.ack.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES"
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.synack.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.fin.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.reset.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES"
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.syn.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.ack.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.synack.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.fin.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.reset.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.data.packet.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES  "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.data.packet.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and direction = 'INCOMING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name, local_addr, local_port LIMIT MAX TIMESERIES  "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] TCP packet codes",
          "layout": {
            "column": 7,
            "row": 28,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.syn.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES"
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.ack.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES"
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.synack.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.fin.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.reset.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.syn.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.ack.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.synack.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.fin.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.reset.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and type != 'NA' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.data.packet.send) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES   "
              },
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.data.packet.receive) where entity.name IN ({{entity_name}}) and protocol.name = 'tcp' and direction = 'OUTGOING' facet upper(aparse(metricName, 'ebpf.tcp.*')), entity.name LIMIT MAX TIMESERIES    "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] TCP packet delivery latency",
          "layout": {
            "column": 1,
            "row": 31,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT percentile(ebpf.tcp.packet_latency_avg, {{percentile_value}})/1000000 where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' and metricName='ebpf.tcp.packet_latency_avg' and ebpf.tcp.packet_latency_avg IS NOT NULL FACET entity.name, local_addr, local_port LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] TCP packet delivery latency",
          "layout": {
            "column": 7,
            "row": 31,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "markers": {
              "displayedTypes": {
                "criticalViolations": false,
                "deployments": true,
                "relatedDeployments": true,
                "warningViolations": false
              }
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT percentile(ebpf.tcp.packet_latency_avg, {{percentile_value}})/1000000 where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' and metricName='ebpf.tcp.packet_latency_avg' and ebpf.tcp.packet_latency_avg IS NOT NULL FACET entity.name LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "thresholds": {
              "isLabelVisible": true
            },
            "units": {
              "unit": "MS"
            },
            "yAxisLeft": {
              "zero": true
            },
            "yAxisRight": {
              "zero": true
            }
          }
        },
        {
          "title": "[INBOUND CONNECTIONS] short lived connection duration (ms)",
          "layout": {
            "column": 1,
            "row": 34,
            "width": 12,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.heatmap"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT histogram(ebpf.tcp.connection_duration, width: 30000) where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' AND local_port != 0 FACET entity.name, local_addr, local_port LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            }
          }
        },
        {
          "title": "[OUTBOUND CONNECTIONS] short lived connection duration (ms)",
          "layout": {
            "column": 1,
            "row": 37,
            "width": 12,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.heatmap"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT histogram(ebpf.tcp.connection_duration, width: 30000) AS 'Duration' where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' FACET entity.name LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Outbound connections",
          "layout": {
            "column": 1,
            "row": 40,
            "width": 12,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT latest(tcp_established), latest(host.name), latest(container.name), latest(container.id), latest(k8s.deployment.name), latest(k8s.namespace.name), latest(k8s.node.name), latest(k8s.pod.name), sum(ebpf.tcp.connection.open) AS 'Connection Opened', sum(ebpf.tcp.connection.close) AS 'Connection Closed' where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='OUTGOING' and tcp_established!='NA' facet entity.name, local_addr, remote_addr LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            }
          }
        },
        {
          "title": "Inbound Connections",
          "layout": {
            "column": 1,
            "row": 43,
            "width": 12,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT latest(tcp_established), latest(host.name), latest(container.name), latest(container.id), latest(k8s.deployment.name), latest(k8s.namespace.name), latest(k8s.node.name), latest(k8s.pod.name), sum(ebpf.tcp.connection.open) AS 'Connection Opened', sum(ebpf.tcp.connection.close) AS 'Connection Closed' where entity.name IN ({{entity_name}}) and protocol.name='tcp' and direction='INCOMING' and tcp_established!='NA' facet entity.name, local_addr, local_port LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            }
          }
        }
      ]
    },
    {
      "name": "Errors",
      "description": null,
      "widgets": [
        {
          "title": "DNS errors",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 12,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Span SELECT latest(timestamp), latest(deployment.name), latest(dns.rcode_name), latest(host.name), latest(local_addr), latest(local_port), latest(remote.host.name), latest(remote_addr), latest(remote_port), latest(k8s.cluster.name), latest(k8s.deployment.name), latest(k8s.namespace.name), latest(k8s.node.name), latest(k8s.pod.name), latest(container.name), latest(container.id), count(*) AS 'Failure Count' WHERE protocol.name = 'dns' AND dns.query != '' AND dns.query != '[]' AND dns.query IS NOT NULL AND entity.name IN ({{entity_name}}) AND dns.resolved = false FACET entity.name, dns.query LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "refreshRate": {
              "frequency": 30000
            }
          }
        },
        {
          "title": "TCP failures",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 12,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Metric SELECT sum(ebpf.tcp.connection.error) AS 'Error Count', latest(error), latest(timestamp), latest(host.name), latest(k8s.cluster.name), latest(k8s.deployment.name), latest(k8s.namespace.name), latest(k8s.node.name), latest(k8s.pod.name), latest(container.name), latest(container.id)  where entity.name IN ({{entity_name}}) and protocol.name='tcp' and metricName = 'ebpf.tcp.connection.error' and error != '' and error IS NOT NULL FACET entity.name,  local_addr, local_port, direction, remote_addr LIMIT MAX "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "HTTP errors",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 12,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "FROM Span SELECT latest(timestamp), latest(host.name),latest(http.host), latest(http.request.method), latest(http.response.status_code), latest(http.route), latest(local_addr), latest(local_port), latest(remote.host.name), latest(remote_addr), latest(remote_port), latest(k8s.cluster.name), latest(k8s.deployment.name), latest(k8s.namespace.name), latest(k8s.node.name), latest(k8s.pod.name), latest(container.name), latest(container.id), count(*) AS 'Failure Count' WHERE error.group.guid IS NOT NULL AND entity.name IN ({{entity_name}}) FACET error.group.name, error.group.message, entity.name, error.type "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        }
      ]
    }
  ],
  "variables": [
    {
      "name": "entity_name",
      "items": null,
      "defaultValues": [],
      "nrqlQuery": {
        "accountIds": [],
        "query": "FROM Metric SELECT uniques(entity.name) WHERE instrumentation.name = 'nr_ebpf' limit max"
      },
      "options": {
        "ignoreTimeRange": false,
        "excluded": false,
        "showApplyAction": false
      },
      "title": "Entity name",
      "type": "NRQL",
      "isMultiSelection": true,
      "replacementStrategy": "STRING"
    },
    {
      "name": "percentile_value",
      "items": [
        {
          "title": null,
          "value": "50"
        },
        {
          "title": null,
          "value": "95"
        },
        {
          "title": null,
          "value": "99.9"
        },
        {
          "title": null,
          "value": "100"
        }
      ],
      "defaultValues": [
        {
          "value": {
            "string": "100"
          }
        }
      ],
      "nrqlQuery": null,
      "options": {
        "excluded": false
      },
      "title": "Chart Projection %ile",
      "type": "ENUM",
      "isMultiSelection": false,
      "replacementStrategy": "NUMBER"
    }
  ]
}
